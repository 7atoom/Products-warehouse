<div class="space-y-6 mx-8">

  <!--  Form Header-->
  <app-form-header (cancel)="onCancel()"></app-form-header>

  <!-- Form -->
  <div class="bg-white rounded-lg border border-gray-200 p-6 md:p-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">
      {{ mode() === 'create' ? 'Create New Product' : 'Update Product Information' }}
    </h2>

    <form [formGroup]="productForm" (ngSubmit)="handleSubmit()" class="space-y-6">
      <!-- Basic Information -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">
          Basic Information
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-1">
              Product Name *
            </label>
            <input
              type="text"
              id="name"
              formControlName="name"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.name.invalid && productForm.controls.name.touched"
              placeholder="Enter product name"
            />
            <p
              [hidden]="!(productForm.controls.name.invalid && productForm.controls.name.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('name') }}
            </p>
          </div>

          <div>
            <label for="PCode" class="block text-sm font-medium text-gray-700 mb-1">
              PCode *
            </label>
            <input
              type="text"
              id="PCode"
              formControlName="PCode"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.PCode.invalid && productForm.controls.PCode.touched"
              placeholder="e.g., ABC-123-XYZ"
            />
            <p
              [hidden]="!(productForm.controls.PCode.invalid && productForm.controls.PCode.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('PCode') }}
            </p>
          </div>

          <div>
            <label for="category" class="block text-sm font-medium text-gray-700 mb-1">
              Category *
            </label>
            <select
              id="category"
              formControlName="category"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.category.invalid && productForm.controls.category.touched"
              [disabled]="categoriesLoading()"
            >
              <option value="" disabled selected>
                {{ categoriesLoading() ? 'Loading categories...' : 'Select a category' }}
              </option>
              @for (cat of categories(); track cat.id) {
                <option [value]="cat.name">{{ cat.name }}</option>
              }
            </select>
            <p
              [hidden]="!(productForm.controls.category.invalid && productForm.controls.category.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('category') }}
            </p>
          </div>

          <div>
            <label for="supplier" class="block text-sm font-medium text-gray-700 mb-1">
              Supplier *
            </label>
            <input
              type="text"
              id="supplier"
              formControlName="supplier"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.supplier.invalid && productForm.controls.supplier.touched"
              placeholder="Enter supplier name"
            />
            <p
              [hidden]="!(productForm.controls.supplier.invalid && productForm.controls.supplier.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('supplier') }}
            </p>
          </div>

          <div class="md:col-span-2">
            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">
              Description
            </label>
            <textarea
              id="description"
              formControlName="description"
              rows="3"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.description.invalid && productForm.controls.description.touched"
              placeholder="Enter product description"
            ></textarea>
            <p
              [hidden]="!(productForm.controls.description.invalid && productForm.controls.description.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('description') }}
            </p>
          </div>
        </div>
      </div>

      <!-- Inventory & Pricing -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">
          Inventory & Pricing
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="quantity" class="block text-sm font-medium text-gray-700 mb-1">
              Current Quantity *
            </label>
            <input
              type="number"
              id="quantity"
              formControlName="quantity"
              min="0"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.quantity.invalid && productForm.controls.quantity.touched"
              placeholder="0"
            />
            <p
              [hidden]="!(productForm.controls.quantity.invalid && productForm.controls.quantity.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('quantity') }}
            </p>
          </div>

          <div>
            <label for="minStock" class="block text-sm font-medium text-gray-700 mb-1">
              Minimum Stock Level *
            </label>
            <input
              type="number"
              id="minStock"
              formControlName="minStock"
              min="0"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.minStock.invalid && productForm.controls.minStock.touched"
              placeholder="0"
            />
            <p
              [hidden]="!(productForm.controls.minStock.invalid && productForm.controls.minStock.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('minStock') }}
            </p>
          </div>

          <div>
            <label for="price" class="block text-sm font-medium text-gray-700 mb-1">
              Unit Price ($) *
            </label>
            <input
              type="number"
              id="price"
              formControlName="price"
              min="0"
              step="0.01"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.price.invalid && productForm.controls.price.touched"
              placeholder="0.00"
            />
            <p
              [hidden]="!(productForm.controls.price.invalid && productForm.controls.price.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('price') }}
            </p>
          </div>

          <div>
            <label for="location" class="block text-sm font-medium text-gray-700 mb-1">
              Warehouse Location *
            </label>
            <input
              type="text"
              id="location"
              formControlName="location"
              class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              [class.border-red-500]="productForm.controls.location.invalid && productForm.controls.location.touched"
              placeholder="e.g., A-12-03"
            />
            <p
              [hidden]="!(productForm.controls.location.invalid && productForm.controls.location.touched)"
              class="mt-1 text-sm text-red-600"
            >
              {{ getErrorMessage('location') }}
            </p>
          </div>

          <div>
            <label for="lastRestocked" class="block text-sm font-medium text-gray-700 mb-1">
              Last Restocked Date
            </label>
            <input
              type="date"
              id="lastRestocked"
              formControlName="lastRestocked"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <app-form-actions (cancel)="onCancel()"></app-form-actions>

    </form>
  </div>
</div>
